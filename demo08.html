<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <div id="wrapper" style="width: 1000px;"></div>
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script>
      const wrapper = document.querySelector('#wrapper')

      const data = []
      for (let index = 0; index < 100; index++) {
        data.push({
            'id': index,
            'MTTR': Math.random() * 20,
            'MTTA': Math.random() * 20
        })
      }
      data.columns = [
        'id',
        'MTTR',
        'MTTA',
      ]

      const margin = { top: 10, right: 0, bottom: 20, left: 0 }
      const width = 1000
      const height = 100

      const series = d3
        .stack()
        .keys(data.columns.slice(1))(data)
        .map(d => (d.forEach(v => (v.key = d.key)), d))

      console.log(series)

      const color = d3
        .scaleOrdinal()
        .domain(series.map(d => d.key))
        .range(['#0B8800', '#054568'])
        .unknown('#ccc')

      const x = d3
        .scaleBand()
        .domain(data.map((d, i) => i))
        .range([margin.left, width - margin.right])

      const y = d3
        .scaleLinear()
        .domain([0, d3.max(series, d => d3.max(d, d => d[1]))])
        .rangeRound([height - margin.bottom, margin.top])

      const xAxis = g =>
        g
          .attr('transform', `translate(0,${height - margin.bottom})`)
          .call(d3.axisBottom(x).tickSizeOuter(0))
          .call(g => g.selectAll('.domain').remove())
          .call(g => g.selectAll('.tick').remove())

      const yAxis = g =>
        g
          .attr('transform', `translate(${margin.left},0)`)
          .call(d3.axisLeft(y).ticks(null, 's'))
          .call(g => g.selectAll('.domain').remove())
          .call(g => g.selectAll('.tick').remove())

      const svg = d3.create('svg').attr('viewBox', [0, 0, width, height])

      svg
        .append('g')
        .selectAll('g')
        .data(series)
        .join('g')
        .attr('fill', d => color(d.key))
        .selectAll('rect')
        .data(d => d)
        .join('rect')
        .attr('x', (d, i) => x(i))
        .attr('y', d => y(d[1]))
        .attr('height', d => y(d[0]) - y(d[1]))
        .attr('width', x.bandwidth())

      svg.append('g').call(xAxis)

      svg.append('g').call(yAxis)

      
      wrapper.append(svg.node())
    </script>
  </body>
</html>
